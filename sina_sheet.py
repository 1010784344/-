#coding=utf-8
import requests
import json
from sina_in import *
import pandas

def getpare(url):
    fin_result = []
    # url = 'http://api.roll.news.sina.com.cn/zt_list?channel=news&cat_1=gnxw&cat_2==gdxw1||=gatxw||=zs-pl' \
    #       '||=mtjj&level==1||=2&show_ext=1&show_all=1&show_num=22&tag=1&format=json&page=1&callback=newsloadercallback&_=1506938552421'

    res = requests.get(url)
    res.encoding = 'utf-8'
    jd = res.text.lstrip('  newsloadercallback(').rstrip(');')
    jd = json.loads(jd)
    for td in jd['result']['data']:
        fin_result.append(get_detail(td['url']))
    return fin_result


if __name__ == '__main__':
    # 获取分页及每页的数据
    # total_result = []
    # for i in range(1,3):
    #     url = 'http://api.roll.news.sina.com.cn/zt_list?channel=news&cat_1=gnxw&cat_2==gdxw1||=gatxw||=zs-pl' \
    #           '||=mtjj&level==1||=2&show_ext=1&show_all=1&show_num=22&tag=1&format=json&page=%s'%i
    #     print url
    #     total_result.extend(getpare(url))
    # print total_result

#     爬取的数据展示（方便展示）
    total_result = [{'edit': u'\u5f20\u5efa\u5229 ', 'comment': 0, 'sour': u'\u4eba\u6c11\u65e5\u62a5\u653f\u52a1', 'Time': '2017-10-03', 'title': u'\u4e3a\u4e86\u633a\u8d77\u56fd\u4eba\u810a\u6881 \u4ed6\u4e00\u8f88\u5b50\u53ea\u505a\u4e00\u4ef6\u4e8b'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 0, 'sour': u'\u4eba\u6c11\u65e5\u62a5\u6d77\u5916\u7248-\u6d77\u5916\u7f51', 'Time': '2017-10-03', 'title': u'\u83f2\u8b66\u65b9\u7834\u7ed1\u67b6\u6848\uff1a\u6551\u51fa1\u540d\u4e2d\u56fd\u4eba \u902e\u63553\u540d\u4e2d\u56fd\u4eba'}, {'edit': u'\u6842\u5f3a ', 'comment': 0, 'sour': u'\u6cd5\u5236\u665a\u62a5', 'Time': '2017-10-03', 'title': u'\u9ed1\u9f99\u6c5f\u8b66\u65b9\u9996\u6b21\u5047\u671f\u76f4\u64ad \u8b66\u82b1\u4e0e70\u4e07\u7f51\u53cb\u901b\u666f\u70b9'}, {'edit': u'\u6842\u5f3a ', 'comment': 0, 'sour': u'\u73af\u7403\u7f51', 'Time': '2017-10-03', 'title': u'\u53f0\u673a\u7ec4\u4eba\u5458\u88ab\u5361\u5854\u5c14\u822a\u7a7a\u8981\u6c42\u56fd\u7c4d\u6539\u6210\u4e2d\u56fd'}, {'edit': u'\u6842\u5f3a ', 'comment': 0, 'sour': u'\u65b0\u4eac\u62a5', 'Time': '2017-10-03', 'title': u'\u5927\u5e7f\u9ad8\u901f\u4e00\u5ba2\u8f66\u53d1\u751f\u4fa7\u7ffb \u81f45\u6b7b38\u4f24'}, {'edit': u'\u6842\u5f3a ', 'comment': 2, 'sour': u'\u6f8e\u6e43\u65b0\u95fb', 'Time': '2017-10-03', 'title': u'\u5171\u9752\u56e2\u4e2d\u592e\uff1a\u672a\u5728\u63a8\u7279\u5f00\u8bbe\u5e10\u53f7 \u73b0\u5b58\u5747\u4e3a\u5047\u5192'}, {'edit': u'\u6842\u5f3a ', 'comment': 0, 'sour': u'\u6f8e\u6e43\u65b0\u95fb', 'Time': '2017-10-03', 'title': u'\u56fd\u5e86\u7b2c\u4e8c\u5929\u65c5\u6e38\u6536\u5165937\u4ebf \u4e2d\u4e1c\u90e8\u5c06\u5927\u5e45\u964d\u6e29'}, {'edit': u'\u6842\u5f3a ', 'comment': 165, 'sour': u'\u6f8e\u6e43\u65b0\u95fb', 'Time': '2017-10-03', 'title': u'\u5b8b\u6c5d\u7a91\u5929\u9752\u91c9\u6d17\u62cd\u51fa\u8fd13\u4ebf \u7834\u4e2d\u56fd\u74f7\u5668\u62cd\u5356\u7eaa\u5f55'}, {'edit': u'\u6842\u5f3a ', 'comment': 66, 'sour': u'\u6cd5\u5236\u665a\u62a5', 'Time': '2017-10-03', 'title': u'\u5403\u4e2a\u6708\u997c\u7b49\u4e8e\u559d\u6389\u4e09\u52fa\u6cb9\uff1f \u5343\u4e07\u522b\u6709\u8fd9\u6837\u7684\u5403\u6cd5'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 0, 'sour': u'\u73af\u7403\u7f51', 'Time': '2017-10-03', 'title': u'\u53f0\u5a92\u547c\u5401\u5f53\u5c40\u901f\u5ba1\u4e24\u5cb8\u670d\u8d38\u534f\u8bae:\u628a\u63e1\u6700\u540e\u7684\u673a\u4f1a'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 1, 'sour': u'\u53c2\u8003\u6d88\u606f', 'Time': '2017-10-03', 'title': u'\u5916\u5a92\uff1a\u4e2d\u56fd\u521d\u521b\u4f01\u4e1a\u6d77\u5916\u5bfb\u673a\u9047 \u540c\u5168\u7403\u4f01\u4e1a\u7ade\u4e89'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 11, 'sour': u'\u592e\u89c6\u65b0\u95fb', 'Time': '2017-10-03', 'title': u'\u4e2d\u56fd\u6d77\u519b\u8230\u8247\u7f16\u961f\u5b8c\u6210\u4e2d\u4fc4\u8054\u6f14\u4efb\u52a1\u8fd4\u56de\u9752\u5c9b'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 0, 'sour': u'\u53c2\u8003\u6d88\u606f', 'Time': '2017-10-03', 'title': u'\u6797\u90d1\u6708\u5a25\u56fd\u5e86\u81f4\u8f9e:\u7956\u56fd\u662f\u9999\u6e2f\u6218\u80dc\u6311\u6218\u5e95\u6c14\u6240\u5728'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 0, 'sour': u'\u53c2\u8003\u6d88\u606f', 'Time': '2017-10-03', 'title': u'\u5916\u5a92\uff1a\u4e2d\u56fd\u6e38\u5ba2\u51fa\u624b\u9614\u7ef0 \u6fb3\u623f\u4ea7\u4e1a\u6293\u9ec4\u91d1\u5468\u5546\u673a'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 1, 'sour': u'\u73af\u7403\u7f51', 'Time': '2017-10-03', 'title': u'\u8521\u82f1\u6587\u629b\u201c\u5baa\u6539\u201d\u8bae\u9898 \u906d\u524d\u6c11\u8fdb\u515a\u201c\u7acb\u59d4\u201d\u6012\u6279'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 1, 'sour': u'\u4e2d\u56fd\u65b0\u95fb\u7f51', 'Time': '2017-10-03', 'title': u'\u4e2d\u5916\u673a\u6784\u9884\u6d4b\u4e2d\u56fd\u7ecf\u6d4e\uff1a\u4ecd\u5c06\u4fdd\u6301\u5f3a\u52b2\u589e\u957f'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 0, 'sour': u'\u592e\u89c6\u65b0\u95fb', 'Time': '2017-10-03', 'title': u'\u98d3\u98ce\u88ad\u591a\u7c73\u5c3c\u514b \u4e2d\u56fd\u5927\u4f7f\uff1a\u9f50\u5fc3\u534f\u529b\u52a9\u540c\u80de\u56de\u5bb6'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 15, 'sour': u'\u73af\u7403\u7f51', 'Time': '2017-10-03', 'title': u'\u6e2f\u5a92\uff1a\u6709\u4eba\u4f01\u56fe\u901a\u8fc7\u201c\u5e9f\u7701\u201d\u641e\u201c\u6e10\u8fdb\u5f0f\u53f0\u72ec\u201d'}, {'edit': u'\u6842\u5f3a ', 'comment': 0, 'sour': u'\u6f8e\u6e43\u65b0\u95fb', 'Time': '2017-10-03', 'title': u'\u8d4c\u57ce\u67aa\u51fb\u6848\u53d7\u56f0\u4e2d\u56fd\u6e38\u5ba2\u5df2\u64a4\u79bb\u5c01\u9501\u533a \u7ee7\u7eed\u65c5\u6e38'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 1, 'sour': u'\u4e2d\u56fd\u65b0\u95fb\u7f51', 'Time': '2017-10-03', 'title': u'\u5341\u4e5d\u5927\u4ee3\u8868\u4e2d\u8fd933.7%\u56e0\u4f55\u4e0d\u5e73\u51e1\uff1f'}, {'edit': u'\u6842\u5f3a ', 'comment': 0, 'sour': u'\u89e3\u653e\u65e5\u62a5', 'Time': '2017-10-03', 'title': u'\u4eba\u6c11\u5927\u4f1a\u5802\u91d1\u8272\u5927\u5385\u5f88\u5fd9 \u90fd\u6709\u8c01\u5728\u7528\uff1f'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 35, 'sour': u'\u73af\u7403\u7f51', 'Time': '2017-10-03', 'title': u'\u5168\u53f0\u8d85\u8fc7450\u5bb6\u6c11\u5bbf\u6c42\u552e \u8fd9\u56de\u9646\u5ba2\u7ec8\u4e8e\u4e0d\u518d\u80cc\u9505'}, {'edit': u'\u6842\u5f3a ', 'comment': 7, 'sour': u'\u6cd5\u5236\u665a\u62a5', 'Time': '2017-10-03', 'title': u'\u4e2d\u56fd\u59d1\u5a18\u4eb2\u5386\u8d4c\u57ce\u67aa\u51fb\u6848\uff1a\u6211\u4eec\u4e00\u8def\u72c2\u5954'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 4, 'sour': u'\u73af\u7403\u7f51', 'Time': '2017-10-03', 'title': u'\u7f8e\u53d1\u751f\u4e25\u91cd\u67aa\u51fb\u4e8b\u4ef6 \u4e2d\u65c5\u96c6\u56e2\u542f\u52a8\u7d27\u6025\u9884\u6848'}, {'edit': u'\u6842\u5f3a ', 'comment': 13, 'sour': u'\u65b0\u4eac\u62a5', 'Time': '2017-10-03', 'title': u'\u8521\u5947\u517c\u4efb\u9996\u89c4\u59d4\u4e3b\u4efb \u8fd9\u4e2a\u673a\u6784\u662f\u5565\u6765\u5934\uff1f'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 0, 'sour': u'\u592e\u89c6\u65b0\u95fb', 'Time': '2017-10-03', 'title': u'\u6df1\u6d77\u52c7\u58eb\u53f7\u6f5c\u6c34\u5668\u8fd4\u822a \u633a\u8fd1\u6df1\u6d77\u518d\u589e\u5927\u56fd\u91cd\u5668'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 1, 'sour': u'\u592e\u89c6\u65b0\u95fb', 'Time': '2017-10-03', 'title': u'\u4e2d\u4f7f\u9986\uff1a\u8d74\u9a6c\u5c14\u4ee3\u592b\u6e38\u5ba2\u6ce8\u610f\u6c34\u4e0a\u6d3b\u52a8\u5b89\u5168'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 301, 'sour': u'\u73af\u7403\u7f51', 'Time': '2017-10-03', 'title': u'\u4fc4\u4e13\u5bb6\uff1a\u6b7c20\u662f\u771f\u6b63\u4e94\u4ee3\u673a \u5b8c\u5168\u662f\u4e2d\u56fd\u72ec\u7acb\u7814\u53d1'}, {'edit': u'\u6842\u5f3a ', 'comment': 243, 'sour': u'\u6f8e\u6e43\u65b0\u95fb', 'Time': '2017-10-03', 'title': u'\u5047\u671f\u5fc5\u5907\uff1a\u65c5\u9014\u4e2d\u4e22\u8eab\u4efd\u8bc1 9\u5f20\u56fe\u6559\u4f60\u600e\u4e48\u529e'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 2, 'sour': u'\u73af\u7403\u7f51', 'Time': '2017-10-03', 'title': u'\u8521\u82f1\u6587\u8868\u59d0\u4e0d\u6ee1\u88ab\u53eb\u795e\u9690\u90e8\u957f \u7f51\u53cb\uff1a\u85aa\u6c34\u5c0f\u5077'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 1, 'sour': u'\u4e2d\u56fd\u65b0\u95fb\u7f51', 'Time': '2017-10-03', 'title': u'\u957f\u5047\u524d\u4e24\u65e5\u5168\u56fd\u63a5\u5f852.27\u4ebf\u4eba\u6b21 \u7ea2\u8272\u65c5\u6e38\u53d7\u9752\u7750'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 49, 'sour': u'\u73af\u7403\u7f51', 'Time': '2017-10-03', 'title': u'\u8521\u82f1\u6587\u7ecf\u8fc7\u793e\u533a\u7ba1\u52361.5\u5c0f\u65f6 \u56fd\u6c11\u515a:\u50cf\u7687\u5e1d\u51fa\u5de1'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 210, 'sour': u'\u73af\u7403\u65f6\u62a5', 'Time': '2017-10-03', 'title': u'\u90ed\u4f2f\u96c4\u5ead\u5ba1\u89c6\u9891\u5f90\u624d\u539a\u5fcf\u6094\u4e66\u9996\u6b21\u66dd\u5149'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 424, 'sour': u'\u65b0\u4eac\u62a5', 'Time': '2017-10-03', 'title': u'\u90ed\u4f2f\u96c4\u5f90\u624d\u539a\u8c37\u4fca\u5c71\u7684\u8fd9\u4e9b\u753b\u9762\u9996\u6b21\u96c6\u4e2d\u66dd\u5149'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 49, 'sour': u'\u65b0\u95fb\u6668\u62a5', 'Time': '2017-10-03', 'title': u'\u7f8e\u56fd\u8d4c\u57ce\u67aa\u51fb\u6848\u5e78\u5b58\u4e2d\u56fd\u4eba:\u7ecf\u5386\u8fd9\u6b21\u6210\u751f\u6b7b\u4e4b\u4ea4'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 565, 'sour': u'\u4e2d\u56fd\u8bc1\u5238\u7f51', 'Time': '2017-10-02', 'title': u'\u672c\u8f6e\u623f\u4ef7\u9886\u6da8\u975e\u5317\u4e0a\u6df1 \u5408\u80a5\u7d2f\u8ba1\u6da8\u5e45\u6700\u5927'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 5, 'sour': u'\u4e2d\u56fd\u5929\u6c14', 'Time': '2017-10-03', 'title': u'\u5317\u4eac\u5c06\u8fce\u516c\u56ed\u6e38\u89c8\u9ad8\u5cf0 \u6700\u4f4e10\u2103\u65e9\u51fa\u665a\u5f52\u9700\u6dfb\u8863'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 10, 'sour': u'\u4e2d\u56fd\u65b0\u95fb\u7f51', 'Time': '2017-10-03', 'title': u'\u6cb3\u5317\u79cb\u51ac\u5927\u6c14\u6c61\u67d3\u6cbb\u9996\u8f6e\u7763\u5bdf\u53d1\u73b0\u95ee\u9898\u8d852\u5343\u4e2a'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 0, 'sour': u'\u73af\u7403\u7f51', 'Time': '2017-10-03', 'title': u'\u97e9\u5a92\uff1a\u4e2d\u56fd\u5c06\u6210\u6838\u7535\u5f3a\u56fd \u8d70\u51fa\u56fd\u95e8\u9891\u83b7\u8ba2\u5355'}, {'edit': u'\u5f20\u5efa\u5229 ', 'comment': 10, 'sour': u'\u89e3\u653e\u65e5\u62a5', 'Time': '2017-10-03', 'title': u'\u82cf\u836348\u9875\u5fcf\u6094\u4e66 \u4e5f\u5199\u4e0d\u5c3d\u5bf9\u56fd\u5bb6\u7684\u4f24\u5bb3'}, {'edit': '', 'comment': 73, 'sour': u'\u4e2d\u56fd\u65e5\u62a5', 'Time': '2017-10-03', 'title': u'\u4e2d\u56fd\u9a7b\u65e7\u91d1\u5c71\u603b\u9886\u4e8b\u5411\u62c9\u65af\u7ef4\u52a0\u65af\u81f4\u6170\u95ee\u7535'}, {'edit': u'\u6842\u5f3a ', 'comment': 29, 'sour': u'\u89e3\u653e\u65e5\u62a5', 'Time': '2017-10-03', 'title': u'\u8521\u82f1\u6587\u60f3\u82b117\u4ebf\u641e\u201c\u90a6\u4ea4\u201d \u8fd9\u6761\u8001\u8def\u8d70\u5f97\u901a\u5417\uff1f'}, {'edit': u'\u67f3\u9f99\u9f99 ', 'comment': 89, 'sour': u'\u53c2\u8003\u6d88\u606f', 'Time': '2017-10-03', 'title': u'\u7f8e\u5a92\uff1a\u4e2d\u4f01\u5c06\u91cf\u4ea7\u4e24\u6816\u65e0\u4eba\u673a \u9664\u9001\u5feb\u9012\u8fd8\u8fd0\u8865\u7ed9'}, {'edit': u'\u67f3\u9f99\u9f99 ', 'comment': 68, 'sour': u'\u53c2\u8003\u6d88\u606f', 'Time': '2017-10-03', 'title': u'\u4e2d\u56fd\u6d77\u7ef5\u57ce\u5e02\u8ba1\u5212:\u5411\u89e3\u51b3\u73af\u5883\u95ee\u9898\u8fc8\u51fa\u5927\u80c6\u4e00\u6b65'}]

    red = pandas.DataFrame(total_result)
    print red.head()
    red.to_excel("C:\\Users\\Administrator\\Desktop\\jpg\\news.xlsx")
